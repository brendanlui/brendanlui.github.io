<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
	<link id="stylecall1" rel="stylesheet" href="/css/academic_style.css" />
	<link id="stylecall2" rel="stylesheet" href="/css/logo_dadiu.css" />
	<link id="stylecall3" rel="stylesheet" href="/css/inputButton.css" />
	<link rel="icon"
	  type="image/png"
	  href="/img/d01.png">
	  <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
	  <script type="text/javascript" src="/js/jquery.scrollTo.js"></script>

	<style>
	.buttonBox{
		width: 100%;
	}

	.buttonJp {
	  padding: 15px 0px;
	  text-align: center;
	  text-decoration: none;
	  display: inline-block;
	  font-size: 16px;
  	border: thick solid white;
		width: 49%;
		font-weight: bold;
	}

	.showText{
		border: thick solid grey;
		background-color: white;
		text-align: center;
	}

	.next{
		background-color: #555555;
  	color: white;
	}

	.buttonJp.active {
	  background-color: #666;
	  color: white;
	}

	.btnFilter{
		width: 32%;
		text-overflow: ellipsis;
  	overflow: hidden;
		padding: 2px 0px;
	}
	</style>

	<meta name="viewport" content="width=device-width, initial-scale=1">
	<style>
	.slidecontainer {
	  width: 100%;
	}

	.slider {
	  -webkit-appearance: none;
	  width: 100%;
	  height: 25px;
	  background: #d3d3d3;
	  outline: none;
	  opacity: 0.7;
	  -webkit-transition: .2s;
	  transition: opacity .2s;
	}

	.slider:hover {
	  opacity: 1;
	}

	.slider::-webkit-slider-thumb {
	  -webkit-appearance: none;
	  appearance: none;
	  width: 25px;
	  height: 25px;
	  background: #7a7679;
	  cursor: pointer;
	}

	.slider::-moz-range-thumb {
	  width: 25px;
	  height: 25px;
	  background: #7a7679;
	  cursor: pointer;
	}
	</style>
</head>

<title>Dadiu | 日語50音</title>

<body onload="restart();">
	<div id="head">
		<a href="/">
		<div id="logo">
			<img src="/img/dadiu.png" alt="dai01" class="logo_dadiu">
		</div>
		</a>
	</div>

	<link rel="stylesheet" href="/css/responsive_bar_style.css">
	<div class="topnav" id="myTopnav">
	  <a href="/">首頁</a>
	</div>
	<div id="buttonBox">
	  <button id="btnFilterAll" class="buttonJp btnFilter active" onclick="filterSelection('All')">所有</button>
	  <button id="btnFilterHiragana" class="buttonJp btnFilter" onclick="filterSelection('Hiragana')">平假名</button>
	  <button id="btnFilterKatakana" class="buttonJp btnFilter" onclick="filterSelection('Katakana')">片假名</button>
	</div>
	<div class="slidecontainer">
		<b>數目 : <span id="demo"></span></b>
	  <input type="range" min="1" max="46" value="46" class="slider" id="myRange">
	</div>


	<script>
		var jpFull = ["あ", "い", "う", "え", "お",
										"か", "き", "く", "け", "こ",
										"さ", "し", "す", "せ", "そ",
										"た", "ち", "つ", "て", "と",
										"な", "に", "ぬ", "ね", "の",
										"は", "ひ", "ふ", "へ", "ほ",
										"ま", "み", "む", "め", "も",
										"や", "ゆ", "よ",
										"ら", "り", "る", "れ", "ろ",
										"わ", "を",
										"ん",
										"が", "ぎ", "ぐ", "げ", "ご",
										"ざ", "じ", "ず", "ぜ", "ぞ",
										"だ", "ぢ", "づ", "で", "ど",
										"ば", "び", "ぶ", "べ", "ぼ",
										"ぱ", "ぴ", "ぷ", "ぺ", "ぽ"
									];
		var jpSimple = ["ア", "イ", "ウ", "エ", "オ",
										"カ", "キ", "ク", "ケ", "コ",
										"サ", "シ", "ス", "セ", "ソ",
										"タ", "チ", "ツ", "テ", "ト",
										"ナ", "ニ", "ヌ", "ネ", "ノ",
										"ハ", "ヒ", "フ", "ヘ", "ホ",
										"マ", "ミ", "ム", "メ", "モ",
										"ヤ", "ユ", "ヨ",
										"ラ", "リ", "ル", "レ", "ロ",
										"ワ", "ヲ",
										"ン",
										"ガ", "ギ", "グ", "ゲ", "ゴ",
										"ザ", "ジ", "ズ", "ゼ", "ゾ",
										"ダ", "ヂ", "ヅ", "デ", "ド",
										"バ", "ビ", "ブ", "ベ", "ボ",
										"パ", "ピ", "プ", "ペ", "ポ"
									];
		var jpChar = ["a", "i", "u", "e", "o",
									"ka", "ki", "ku", "ke", "ko",
									"sa", "shi", "su", "se", "so",
									"ta", "chi", "tsu", "te", "to",
									"na", "ni", "nu", "ne", "no",
									"ha", "hi", "fu", "he", "ho",
									"ma", "mi", "mu", "me", "mo",
									"ya", "yu", "yo",
									"ra", "ri", "ru", "re", "ro",
									"wa", "wo",
									"n",
									"ga", "gi", "gu", "ge", "go",
									"za", "ji", "zu", "ze", "zo",
									"da", "di", "du", "de", "do",
									"ba", "bi", "bu", "be", "bo",
									"pa", "pi", "pu", "pe", "po"
								];
		var total = jpFull.length;
		var full;
		var index = parseInt(Math.random() * (total - 1) + 1, 10);
		var showText = "";
		var correct = 0;
		var ttlAns = 0;
		var mc = {};
		var answered = true;
		var filtered = false;
		var filterHira = false;

		function filterSelection(text){
			var element = document.getElementById("btnFilterHiragana");
	   	element.classList.remove("active");
			element = document.getElementById("btnFilterKatakana");
	   	element.classList.remove("active");
			element = document.getElementById("btnFilterAll");
	   	element.classList.remove("active");

	   	element = document.getElementById("btnFilter" + text);
	   	element.classList.add("active");
			if("Hiragana" == text){
				filtered = true;
				filterHira = true;
			}else if("Katakana" == text){
				filtered = true;
				filterHira = false;
			}else if("All" == text){
				filtered = false;
			}
		}

		function restart(){
			genShowJpText();
			genMC();
			answered = false;
			for(var i = 0; i < mc.length; i ++){
					document.getElementById("mc" + i).style.borderColor  = "#ffffff";
			}
		}

		function genShowJpText(){
			var output = document.getElementById("myRange");
			total = output.value;

			if(!filtered){
				if(Math.random() > 0.5){
					full = true;
				}else{
					full = false;
				}
			}else{
				full = filterHira;
			}
			index = parseInt(Math.random() * (total - 0) + 0, 10);
			if(full){
				showText = jpFull[index];
			}else{
				showText = jpSimple[index];
			}
			document.getElementById("textJapan").innerHTML = showText;
		}

		function genMC(){
			var correctAns = jpChar[index];
			mc = getRandom(jpChar, 4);
			var exist = mc.includes(correctAns);
			if(!exist){
				mc[0] = jpChar[index];
			}
			shuffle(mc);

			for(var i = 0; i < mc.length; i++){
				document.getElementById("mc" + i).innerHTML = mc[i];
			}
		}

		function showResult(mcChoose){
			if(!answered){
				var mcIndex = mc.indexOf(jpChar[index]);
				if(mcIndex != mcChoose){
					document.getElementById("mc" + mcChoose).style.borderColor  = "#FF0000";
				}else{
					correct++;
				}
				document.getElementById("mc" + mcIndex).style.borderColor  = "#4CAF50";
				answered = true;
				ttlAns++;
				document.getElementById("result").innerHTML  = correct + " / " + ttlAns;
			}
		}

		//copy from google start
		function getRandom(arr, n) {
		    var result = new Array(n),
		        len = arr.length,
		        taken = new Array(len);
		    if (n > len)
		        throw new RangeError("getRandom: more elements taken than available");
		    while (n--) {
		        var x = Math.floor(Math.random() * len);
		        result[n] = arr[x in taken ? taken[x] : x];
		        taken[x] = --len in taken ? taken[len] : len;
		    }
		    return result;
		}

		function shuffle(array) {
		  var currentIndex = array.length, temporaryValue, randomIndex;
		  while (0 !== currentIndex) {
		    randomIndex = Math.floor(Math.random() * currentIndex);
		    currentIndex -= 1;
		    temporaryValue = array[currentIndex];
		    array[currentIndex] = array[randomIndex];
		    array[randomIndex] = temporaryValue;
		  }
		  return array;
		}

		// Add active class to the current button (highlight it)
		var btns = document.getElementsByClassName("btnFilter");
		for (var i = 0; i < btns.length; i++) {
		  btns[i].addEventListener("click", function(){
		    var current = document.getElementsByClassName("active");
		    current[0].className = current[0].className.replace(" active", "");
		    this.className += " active";
		  });
		}
		//copy from google end
	</script>

	<script>
	var slider = document.getElementById("myRange");
	var output = document.getElementById("demo");
	output.innerHTML = slider.value;

	slider.oninput = function() {
	  output.innerHTML = this.value;
	}
	</script>

	<p class="showText" style="font-size:10vw;" id="textJapan"></p>

	<div class="buttonBox">
			<button id="mc0" class="buttonJp" type="button" onclick="showResult(0)"></button>
			<button id="mc1" class="buttonJp" type="button" onclick="showResult(1)"></button>
			<br>
			<button id="mc2" class="buttonJp" type="button" onclick="showResult(2)"></button>
			<button id="mc3" class="buttonJp" type="button" onclick="showResult(3)"></button>
	</div>
	<p><button id="next" class="buttonJp next" type="button" onclick="restart()">下一個</button></p>
	<h4 style="text-align: center;" id="result"></h4>

	<ul id="foot">
		</br>
		<li>© Copyright 2019. All Rights Reserved.</li>
	</ul></br>
</body>
</html>
