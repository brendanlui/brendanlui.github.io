<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
	<link id="stylecall1" rel="stylesheet" href="/css/academic_style.css" />
	<link id="stylecall2" rel="stylesheet" href="/css/logo_dadiu.css" />
	<link id="stylecall3" rel="stylesheet" href="/css/inputButton.css" />
	<link rel="icon"
	  type="image/png"
	  href="/img/d01.png">
	  <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
	  <script type="text/javascript" src="/js/jquery.scrollTo.js"></script>

			<!--TODO-->
    <link href="https://cdn-na.infragistics.com/igniteui/2016.2/latest/css/themes/infragistics/infragistics.theme.css" rel="stylesheet" />
    <link href="https://cdn-na.infragistics.com/igniteui/2016.2/latest/css/structure/infragistics.css" rel="stylesheet" />

    <style>
        #sampleContainer ol {
            padding: 0px 0px 0px 15px;
            margin: 0;
        }

        #sampleContainer input {
            margin: 10px 0;
        }
        #result {
            display: none;
            color: red;
        }
    </style>
    <script src="http://ajax.aspnetcdn.com/ajax/modernizr/modernizr-2.8.3.js"></script>
    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>

    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/infragistics.core.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/infragistics.lob.js"></script>

    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_core.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_collections.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_text.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_io.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_ui.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.documents.core_core.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_collectionsextended.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.excel_core.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_threading.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.ext_web.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.xml.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.documents.core_openxml.js"></script>
    <script type="text/javascript" src="http://cdn-na.infragistics.com/igniteui/2019.1/latest/js/modules/infragistics.excel_serialization_openxml.js"></script>

</head>

<title>Dadiu | Rich Forex</title>

<body onload="">
	<div id="head">
		<div id="logo">
			<img src="/img/dadiu.png" alt="dai01" class="logo_dadiu">
		</div>
	</div>

	<link rel="stylesheet" href="/css/responsive_bar_style.css">
	<div class="topnav" id="myTopnav">
	  <a href="/">Home</a>
	</div>

	<!--TODO-->
	<div>
			<input type="file" id="input" accept="application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"/>
			<div id="result"></div>
			<table id="grid1"></table>
	</div>
	<script>

			$(function () {
					$("#input").on("change", function () {
							var excelFile,
									fileReader = new FileReader();

							$("#result").hide();

							fileReader.onload = function (e) {
									var buffer = new Uint8Array(fileReader.result);

									$.ig.excel.Workbook.load(buffer, function (workbook) {
											var column, row, newRow, cellValue, columnIndex, i,
													worksheet = workbook.worksheets(0),
													columnsNumber = 0,
													gridColumns = [],
													data = [],
													worksheetRowsCount;

											// Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
											// So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
											while (worksheet.rows(0).getCellValue(columnsNumber)) {
													columnsNumber++;
											}

											// Iterating through cells in first row and use the cell text as key and header text for the grid columns
											for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
													column = worksheet.rows(0).getCellText(columnIndex);
													gridColumns.push({ headerText: column, key: column });
											}

											// We start iterating from 1, because we already read the first row to build the gridColumns array above
											// We use each cell value and add it to json array, which will be used as dataSource for the grid
											for (i = 1, worksheetRowsCount = worksheet.rows().count() ; i < worksheetRowsCount; i++) {
													newRow = {};
													row = worksheet.rows(i);

													for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
															cellValue = row.getCellText(columnIndex);
															newRow[gridColumns[columnIndex].key] = cellValue;
													}

													data.push(newRow);
											}
											console.log(data);
											console.log(data[0]["總和"]);
											console.log(data[1]["總和"]);
											// we can also skip passing the gridColumns use autoGenerateColumns = true, or modify the gridColumns array
											createGrid(data, gridColumns);
									}, function (error) {
											$("#result").text("The excel file is corrupted.");
											$("#result").show(1000);
									});
							}

							if (this.files.length > 0) {
									excelFile = this.files[0];
									if (excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) {
											fileReader.readAsArrayBuffer(excelFile);
									} else {
											$("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
											$("#result").show(1000);
									}
							}

					})
			});

			function createGrid(data, gridColumns) {
					if ($("#grid1").data("igGrid") !== undefined) {
							$("#grid1").igGrid("destroy");
					}

					$("#grid1").igGrid({
							columns: gridColumns,
							autoGenerateColumns: true,
							dataSource: data,
							width: "100%"
					});
			}
	</script>

	<ul id="foot">
		</br>
		<li>© Copyright 2019. All Rights Reserved.</li>
	</ul></br>
</body>
</html>
