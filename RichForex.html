<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
	<link id="stylecall1" rel="stylesheet" href="/css/academic_style.css" />
	<link id="stylecall2" rel="stylesheet" href="/css/logo_dadiu.css" />
	<link id="stylecall3" rel="stylesheet" href="/css/inputButton.css" />
	<link rel="icon"
	  type="image/png"
	  href="/img/d01.png">
	  <script type="text/javascript" src="/js/jquery-1.10.2.min.js"></script>
	  <script type="text/javascript" src="/js/jquery.scrollTo.js"></script>
</head>

<title>Dadiu | Rich Forex</title>

<body onload="">
	<div id="head">
		<div id="logo">
			<img src="/img/dadiu.png" alt="dai01" class="logo_dadiu">
		</div>
	</div>

	<link rel="stylesheet" href="/css/responsive_bar_style.css">
	<div class="topnav" id="myTopnav">
	  <a href="/">Home</a>
	</div>

	<!--TODO-->
	<div>

			<form>
			  		<label for="lname">Month</label>
						<input type="text" id="month" onchange="handleMonth(this);" placeholder="Month"/>
			</form>
			<div class="upload-btn-wrapper">
				<input type="file" id="fileUpload" />
				<input type="button" id="upload" value="Input" onclick="Upload()" />
			</div>
			<table id="tableData"></table>

			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/xlsx.full.min.js"></script>
			<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.13.5/jszip.js"></script>
			<script type="text/javascript">

				function handleMonth(input) {
					if (isNaN(input.value)) input.value = 1;
					if (input.value < 1) input.value = 1;
					if (input.value > 12) input.value = 12;
				}

		    function Upload() {
		        //Reference the FileUpload element.
		        var fileUpload = document.getElementById("fileUpload");

		        //Validate whether File is valid Excel file.
		        var regex = /^([a-zA-Z0-9\s_\\.\-:])+(.xls|.xlsx)$/;
		        if (regex.test(fileUpload.value.toLowerCase())) {
		            if (typeof (FileReader) != "undefined") {
		                var reader = new FileReader();

		                //For Browsers other than IE.
		                if (reader.readAsBinaryString) {
		                    reader.onload = function (e) {
		                        ProcessExcel(e.target.result);
		                    };
		                    reader.readAsBinaryString(fileUpload.files[0]);
		                } else {
		                    //For IE Browser.
		                    reader.onload = function (e) {
		                        var data = "";
		                        var bytes = new Uint8Array(e.target.result);
		                        for (var i = 0; i < bytes.byteLength; i++) {
		                            data += String.fromCharCode(bytes[i]);
		                        }
		                        ProcessExcel(data);
		                    };
		                    reader.readAsArrayBuffer(fileUpload.files[0]);
		                }
		            } else {
		                alert("This browser does not support HTML5.");
		            }
		        } else {
		            alert("Please upload a valid Excel file.");
		        }
		    };

		    function ProcessExcel(data) {
		        //Read the Excel File data.
		        var workbook = XLSX.read(data, {
		            type: 'binary'
		        });

		        //Fetch the name of First Sheet.
		        var firstSheet = workbook.SheetNames[0];

		        //Read all rows from First Sheet into an JSON array.
		        var excelRows = XLSX.utils.sheet_to_row_object_array(workbook.Sheets[firstSheet]);

						var keyNames = Object.keys(excelRows[0]);
						console.log(keyNames);
						console.log(excelRows);
						createGrid(keyNames, excelRows);
		    };


				function createGrid(keyNames, excelRows) {
					var tableString = "";
					tableString = "";
					tableString += "<tr>";
					for(i = 0; i < keyNames.length; i++){
							var value = keyNames[i];
							if(!value){
								value = "";
							}
							tableString += "<th>" + keyNames[i] + "</th>";
					}
					tableString += "</tr>";

					for(i = 0; i < excelRows.length; i++){
						tableString += "<tr>";
						for(j = 0; j < keyNames.length; j++){
							var value = excelRows[i][keyNames[j]];
							if(!value){
								value = "";
							}
							tableString += "<td>" + value + "</td>";
						}
						tableString += "</tr>";
					}
					document.getElementById("tableData").innerHTML = tableString;
				}
			</script>

			<style>
			input[type=text] {
			  width: 100%;
			  padding: 12px 20px;
			  margin: 8px 0;
			  box-sizing: border-box;
			}

			#tableData {
			  font-family: "Trebuchet MS", Arial, Helvetica, sans-serif;
			  border-collapse: collapse;
			  width: 100%;
			}

			#tableData td, #tableData th {
			  border: 1px solid #ddd;
			  padding: 8px;
			}

			#tableData tr:nth-child(even){background-color: #f2f2f2;}

			#tableData tr:hover {background-color: #ddd;}

			#tableData th {
			  padding-top: 12px;
			  padding-bottom: 12px;
			  text-align: left;
			  background-color: #737373;
			  color: white;
			}
			</style>
	</div>

	<ul id="foot">
		</br>
		<li>Â© Copyright 2019. All Rights Reserved.</li>
	</ul></br>
</body>
</html>
